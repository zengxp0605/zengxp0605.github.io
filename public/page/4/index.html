<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <link rel="dns-prefetch" href="http://zengxp0605.github.io">
  <title>Jason Zeng</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="tech blog">
<meta property="og:type" content="website">
<meta property="og:title" content="Jason Zeng">
<meta property="og:url" content="http://zengxp0605.github.io/page/4/index.html">
<meta property="og:site_name" content="Jason Zeng">
<meta property="og:description" content="tech blog">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Jason Zeng">
<meta name="twitter:description" content="tech blog">
  
  
    <link rel="icon" href="/assets/images/favicon.png">
  
  <link rel="stylesheet" href="/main.css">
  

</head>

<body>
  <div id="container">
    <div class="left-col">
      <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img src="/assets/images/avatar.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Jason Zeng</a></h1>
		</hgroup>

		
		<p class="header-subtitle">Jason&#39;s personal blog</p>
		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/">主页</a></li>
	        
				<li><a href="/archives">所有文章</a></li>
	        
				<li><a href="/about">关于</a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
	        
    		
    			
    			<a class="js-smart-menu" data-idx="0" href="javascript:void(0)">所有文章</a>
    			
    			
            
    			
    			<a class="js-smart-menu" data-idx="1" href="javascript:void(0)">标签</a>
    			
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
					<a class="github" target="_blank" href="https://github.com/zengxp0605" title="github">github</a>
		        
					<a class="weibo" target="_blank" href="http://weibo.com/shopping0605" title="weibo">weibo</a>
		        
					<a class="mail" target="_blank" href="mailto:xiaoping_zeng@foxmail.com" title="mail">mail</a>
		        
			</div>
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"><i class="icon-list"></i></div>
  		<h1 class="header-author js-mobile-header hide">Jason Zeng</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				
					<img src="/assets/images/avatar.jpg" class="js-avatar">
				
			</div>
			<hgroup>
			  <h1 class="header-author">Jason Zeng</h1>
			</hgroup>
			
			<p class="header-subtitle">Jason&#39;s personal blog</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
					<li><a href="/about">关于</a></li>
		        
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/zengxp0605" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/shopping0605" title="weibo">weibo</a>
			        
						<a class="mail" target="_blank" href="mailto:xiaoping_zeng@foxmail.com" title="mail">mail</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap">
        
  
    <article id="post-Git-Usage-Detail" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/02/Git-Usage-Detail/">Git 使用详解</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="git-小技巧"><a href="#git-小技巧" class="headerlink" title="git 小技巧"></a>git 小技巧</h3><h4 id="git-打包发布zip包"><a href="#git-打包发布zip包" class="headerlink" title="git 打包发布zip包"></a>git 打包发布zip包</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># git 归档方式，但会包含文件夹下现有文件</div><div class="line">git archive -o 123.zip HEAD $(git diff --name-only &lt;历史版本sha1 号&gt;^) </div><div class="line"># 使用管道方式打zip 包</div><div class="line">git diff &lt;新版本号-sha1&gt; &lt;历史版本号-sha1&gt; --name-only | xargs zip update.zip</div><div class="line"># 使用管道方式打zip 包，不指定版本号，而是直接打当前分支和其他分支的差异文件包(比如：比较远端的master和本分支的差异文件打包上线）</div><div class="line">git diff origin/master --name-only | xargs zip package.zip</div></pre></td></tr></table></figure>
<h4 id="修改最近一次提交说明"><a href="#修改最近一次提交说明" class="headerlink" title="修改最近一次提交说明"></a>修改最近一次提交说明</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git commit –amend</div></pre></td></tr></table></figure>
<h4 id="不产生无用的merge的同步"><a href="#不产生无用的merge的同步" class="headerlink" title="不产生无用的merge的同步"></a>不产生无用的merge的同步</h4><p>使用 git 自身功能来回滚代码，取消上一次的修改应该用，但要注意，虽然代码是实现了回滚，同时也会自动产生一条“回滚代码”的 log 。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git pull --rebase origin master</div></pre></td></tr></table></figure></p>
<h4 id="回滚已上传的更新"><a href="#回滚已上传的更新" class="headerlink" title="回滚已上传的更新"></a>回滚已上传的更新</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git revert &lt;sha1_of_commit&gt;</div></pre></td></tr></table></figure>
<h4 id="回滚master步骤"><a href="#回滚master步骤" class="headerlink" title="回滚master步骤"></a>回滚master步骤</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git reset --hard HEAD~1</div><div class="line">git reset --hard HEAD &lt;需要回滚到的位置&gt;</div><div class="line">git push origin master  --force&lt;强制回滚&gt;</div></pre></td></tr></table></figure>
<h4 id="git-维护"><a href="#git-维护" class="headerlink" title="git 维护"></a>git 维护</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"># 查看本地git 的分布情况</div><div class="line">git count-objects -v</div><div class="line"></div><div class="line"># .git 目录压缩</div><div class="line">git gc --auto</div><div class="line"># git 数据一致性分析，可以找到丢失的commit sha1</div><div class="line">git fsck</div><div class="line"></div><div class="line"># git 数据清理，包括把丢失的commit 从磁盘上物理删除</div><div class="line">git prune</div><div class="line"></div><div class="line"># 建议的命令</div><div class="line">git fsck &amp;&amp; git gc --prune</div><div class="line"> </div><div class="line"># 或者可以尝试</div><div class="line">git reflog expire --expire=now --all &amp;&amp; git gc --aggressive --prune=now</div></pre></td></tr></table></figure>
<h4 id="格式化log-显示样式"><a href="#格式化log-显示样式" class="headerlink" title="格式化log 显示样式"></a>格式化log 显示样式</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"># 先设置一个 config </div><div class="line">git config --global alias.lg &quot;log --color --graph --codetty=format:&apos;%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)&lt;%an&gt;%Creset&apos; --abbrev-commit --&quot;</div><div class="line"> </div><div class="line"># 使用设置好的别名</div><div class="line">git lg</div></pre></td></tr></table></figure>
<h4 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h4><ul>
<li>如果想直接使用 git pull 拉去默认分支,可以在 .git/config 加上<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[branch &quot;master&quot;]</div><div class="line">  remote = origin</div><div class="line">  merge = refs/heads/master</div><div class="line">  rebase = true</div></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="git-设置全局忽略"><a href="#git-设置全局忽略" class="headerlink" title="git 设置全局忽略"></a>git 设置全局忽略</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># 设置全局 忽略列表</div><div class="line">git config --global core.excludesfile ~/.gitignore_global</div><div class="line"></div><div class="line"># 本地生成文件</div><div class="line"></div><div class="line">&gt; ~/.gitignore_global</div></pre></td></tr></table></figure>
<hr>
<h3 id="git-命令行"><a href="#git-命令行" class="headerlink" title="git 命令行"></a>git 命令行</h3><h4 id="add-命令"><a href="#add-命令" class="headerlink" title="add 命令"></a>add 命令</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># 进入交互式界面</div><div class="line">git add -i</div></pre></td></tr></table></figure>
<h4 id="blame-命令"><a href="#blame-命令" class="headerlink" title="blame 命令"></a>blame 命令</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># 显示文件修改日志</div><div class="line">git blame test1.txt</div></pre></td></tr></table></figure>
<h4 id="branch-命令"><a href="#branch-命令" class="headerlink" title="branch 命令"></a>branch 命令</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># 当前所有的branch信息</div><div class="line">git branch -avv</div><div class="line"># 从主分支master创建branch_0.1分支</div><div class="line">git branch branch_0.1 master</div></pre></td></tr></table></figure>
<h4 id="checkout-命令"><a href="#checkout-命令" class="headerlink" title="checkout 命令"></a>checkout 命令</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"># 更新单个文件</div><div class="line">git checkout origin/master -- &lt;文件路径&gt;</div><div class="line"># 更新某个文件的某个版本</div><div class="line">git checkout origin/master &lt;commit sha1&gt; -- &lt;文件路径&gt;</div><div class="line"></div><div class="line">#切换整个工作区到某个历史版本</div><div class="line">git checkout &lt;commit sha1&gt;</div><div class="line">git checkout HEAD^ # 回滚内容到上一个版本，效果同 git reset</div><div class="line"></div><div class="line"># 从远程分支更新到本地新建一个分支</div><div class="line">git checkout -b &lt;本地新分支名&gt; &lt;远端名称&gt;/&lt;远程分支名&gt;</div></pre></td></tr></table></figure>
<h4 id="config-命令"><a href="#config-命令" class="headerlink" title="config 命令"></a>config 命令</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git config --global user.name &quot;yourname&quot;</div><div class="line">git config --global user.email your@exam.com</div></pre></td></tr></table></figure>
<h4 id="clone-命令"><a href="#clone-命令" class="headerlink" title="clone 命令"></a>clone 命令</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">#仅获取最新版和一个历史版本,即最后2个版本</div><div class="line">git clone &lt;git path url&gt; --depth=1</div><div class="line"># 检查log 版本</div><div class="line">git rev-list master</div><div class="line"># 或者</div><div class="line">git rev-list master --max-count=10</div></pre></td></tr></table></figure>
<h4 id="commit-命令"><a href="#commit-命令" class="headerlink" title="commit 命令"></a>commit 命令</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># 使用最近commit增补提交，不产生新的commit log</div><div class="line">git commit -C HEAD –amend</div><div class="line">#  -a是提交所有改动，-m是加入log信息</div><div class="line">git commit -a -m &quot;log_message&quot;</div></pre></td></tr></table></figure>
<h4 id="fetch-命令"><a href="#fetch-命令" class="headerlink" title="fetch 命令"></a>fetch 命令</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># 获取远程信息</div><div class="line">git fetch</div><div class="line"># 精简获取部分远程</div><div class="line">git fetch --depth=&lt;版本数量&gt;</div></pre></td></tr></table></figure>
<h4 id="log-命令"><a href="#log-命令" class="headerlink" title="log 命令"></a>log 命令</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"># 精简查看历史提交记录</div><div class="line">git log --oneline -&lt;行数&gt;</div><div class="line"></div><div class="line">#查看某个文件的修改日志</div><div class="line">git log --pretty=oneline 文件名</div><div class="line"></div><div class="line">#查看文件的修改内容 (后面的为哈希值)</div><div class="line">git show 7957045706302a92453fecb22806072872bb4f97</div></pre></td></tr></table></figure>
<h4 id="diff-命令"><a href="#diff-命令" class="headerlink" title="diff 命令"></a>diff 命令</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#查看未提交文件的修改</div><div class="line">git diff FILENAME</div></pre></td></tr></table></figure>
<h4 id="stash-命令"><a href="#stash-命令" class="headerlink" title="stash 命令"></a>stash 命令</h4><blockquote>
<p>参考:  <a href="http://www.williamsang.com/archives/2347.html?utm_source=tuicool&amp;utm_medium=referral" target="_blank" rel="external">http://www.williamsang.com/archives/2347.html?utm_source=tuicool&amp;utm_medium=referral</a><br>这个命令保存add的新文件,或者的文件到缓存区,  commit 后的内容不会保存<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"># 将当前修改存入缓存区(不会被提交)</div><div class="line">git stash </div><div class="line"># 查看缓存区列表</div><div class="line">git stash list</div><div class="line"></div><div class="line"># 恢复暂存区和工作区进度</div><div class="line">git stash pop --index stash@&#123;0&#125;</div><div class="line"></div><div class="line"># 其他</div><div class="line">git stash [save message] [-k|--no-keep-index] [--patch]</div><div class="line">git stash apply [--index] [&lt;stash&gt;] 不删除已恢复的进度，其他同git stash pop</div><div class="line">git stash drop [&lt;stash&gt;] 删除某一个进度，默认删除最新进度</div><div class="line">git stash clear 删除所有进度</div><div class="line">git stash branch &lt;branchname&gt; &lt;stash&gt; 基于进度创建分支</div></pre></td></tr></table></figure></p>
</blockquote>
<h4 id="merge-命令"><a href="#merge-命令" class="headerlink" title="merge 命令"></a>merge 命令</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># 撤销当前merge 中的状态</div><div class="line">$ git merge --abort</div></pre></td></tr></table></figure>
<h4 id="push-命令"><a href="#push-命令" class="headerlink" title="push 命令"></a>push 命令</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"># 提交本地test分支作为远程的master分支</div><div class="line">git push origin test:master</div><div class="line"> </div><div class="line"># 提交本地test分支作为远程的test分支</div><div class="line">git push origin test:test</div><div class="line"> </div><div class="line"># 如果想删除远程的分支呢？类似于上面，如果:左边的分支为空，那么将删除:右边的远程的分支。</div><div class="line"># 刚提交到远程的test将被删除，但是本地还会保存的，不用担心。</div><div class="line">$ git push origin :test  --force&lt;此参数表示强制push 可能会对冲掉新的push 结果&gt;</div></pre></td></tr></table></figure>
<h4 id="svn-命令"><a href="#svn-命令" class="headerlink" title="svn 命令"></a>svn 命令</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># 关联svn</div><div class="line">git svn init &lt;url&gt; --no-metadata --no-minimize-url -T &lt;主干名，一般为trunk&gt;</div></pre></td></tr></table></figure>
<h4 id="reset-命令"><a href="#reset-命令" class="headerlink" title="reset 命令"></a>reset 命令</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># 将版本库恢复到HEAD之前的版本</div><div class="line">* git reset --hard HEAD~1</div><div class="line">* git reset --hard HEAD &lt;版本号&gt;</div></pre></td></tr></table></figure>
<h4 id="remote"><a href="#remote" class="headerlink" title="remote"></a>remote</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"># 查看远程仓库</div><div class="line">git remote -v</div><div class="line"># 添加远程仓库</div><div class="line">git remote add [name] [url]</div><div class="line">#如: get remote add origin https://github.com/zengxp0605/test.git</div><div class="line"></div><div class="line">#删除远程仓库</div><div class="line">git remote rm [name]</div><div class="line"># 修改远程仓库</div><div class="line">git remote set-url –push[name][newUrl]</div><div class="line"># 拉取远程仓库</div><div class="line">git pull/fetch [remoteName] [localBranchName]</div><div class="line"># 推送远程仓库</div><div class="line">git push [remoteName] [localBranchName]</div><div class="line"># 删除远端已删除，但是本地信息还有分支</div><div class="line">git remote prune [origin]</div></pre></td></tr></table></figure>
<h4 id="tags-命令"><a href="#tags-命令" class="headerlink" title="tags 命令"></a>tags 命令</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"># 查看本地tags </div><div class="line">git tag -l</div><div class="line"> </div><div class="line"># push到服务器端 </div><div class="line">git push --tags </div><div class="line"> </div><div class="line"># 删除本地tag </div><div class="line">git tag -d v1.1</div><div class="line"> </div><div class="line"># 补打标签</div><div class="line">git tag -a v0.1.1 [版本号]</div></pre></td></tr></table></figure>
<h4 id="files-命令"><a href="#files-命令" class="headerlink" title="files 命令"></a>files 命令</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># 恢复多个删除的本地文件</div><div class="line">git ls-files -d | xargs -i git checkout &#123;&#125;</div></pre></td></tr></table></figure>
<h4 id="git-保存http下的用户名密码"><a href="#git-保存http下的用户名密码" class="headerlink" title="git 保存http下的用户名密码"></a>git 保存http下的用户名密码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git config --global credential.helper store</div></pre></td></tr></table></figure>
<h3 id="gitconfig-配置"><a href="#gitconfig-配置" class="headerlink" title="gitconfig 配置"></a>gitconfig 配置</h3><file txt="" .gitconfig=""><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line">[user]</div><div class="line">    name = Jason</div><div class="line">    email = jason_zeng@admin.com</div><div class="line">[core]</div><div class="line">    autocrlf = true</div><div class="line">    excludesfile = d:/Users/jason/.gitignore_global</div><div class="line">    trustctime = false</div><div class="line">    editor = vim</div><div class="line">    filemode = false</div><div class="line">[http]</div><div class="line">    # 缓存区大小</div><div class="line">    postBuffer = 1048576000</div><div class="line">[diff]</div><div class="line">    tool = sourcetree</div><div class="line">[difftool]</div><div class="line">    prompt = false</div><div class="line">[difftool &quot;sourcetree &quot;]</div><div class="line">    cmd = &apos;D:/Tools/BeyondCompare/BComp.exe&apos; \&quot;$LOCAL\&quot; \&quot;$REMOTE\&quot;</div><div class="line">[merge]</div><div class="line">    tool = sourcetree</div><div class="line">[mergetool]</div><div class="line">    prompt = false</div><div class="line">[mergetool &quot;sourcetree&quot;]</div><div class="line">    cmd = &apos;D:/Tools/BeyondCompare/BComp.exe&apos; \&quot;$LOCAL\&quot; \&quot;$REMOTE\&quot; \&quot;$BASE\&quot; \&quot;$MERGED\&quot;</div><div class="line">    trustExitCode = true</div><div class="line">[alias]</div><div class="line">    # 别名</div><div class="line">    lg = log --color --graph --pretty=format:&apos;%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)&lt;%an&gt;%Creset&apos; --abbrev-commit --</div><div class="line">    co = checkout</div><div class="line">    cl = clone</div><div class="line">    ci = commit</div><div class="line">    st = status -sb</div><div class="line">    br = branch</div><div class="line">    unstage = reset HEAD --</div><div class="line">    dc = diff --cached</div><div class="line">[credential]</div><div class="line">    # http协议仓库,保持用户名和密码</div><div class="line">    helper = store</div><div class="line">[push]</div><div class="line">    default = matching</div><div class="line">[color]</div><div class="line">    ui = true</div><div class="line">[pack]</div><div class="line">    windowMemory = 1G</div><div class="line">    SizeLimit = 100m</div><div class="line">    threads = 1</div><div class="line">    window = 0</div><div class="line">    packSizeLimit = 100m</div></pre></td></tr></table></figure><br><br></file>


<h3 id="Sourcetree常用工具和配置方式"><a href="#Sourcetree常用工具和配置方式" class="headerlink" title="Sourcetree常用工具和配置方式"></a>Sourcetree常用工具和配置方式</h3><p>BeyondCompare定义为默认工具</p>
<ul>
<li>点击 工具-&gt;选项</li>
<li>在弹出框选择 比较 </li>
<li>外部对比工具 选择Beyond Compare </li>
<li>合并工具 选择Beyond Compare</li>
<li>找到本机git配置文件 .gitconfig</li>
<li>添加如下配置</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[difftool &quot;sourcetree&quot;]</div><div class="line">cmd = &apos;/d/Tools/BeyondCompare/BComp.exe&apos; \&quot;$LOCAL\&quot; \&quot;$REMOTE\&quot;</div><div class="line">[mergetool &quot;sourcetree&quot;]</div><div class="line">cmd = &apos;/d/Tools/BeyondCompare/BComp.exe&apos; \&quot;$LOCAL\&quot; \&quot;$REMOTE\&quot; \&quot;$BASE\&quot; \&quot;$MERGED\&quot;</div><div class="line">trustExitCode = true</div></pre></td></tr></table></figure>
<blockquote>
<p>提醒：把 d:/ 改成 Bash 下的 /d/ </p>
</blockquote>
<h3 id="详见-https-github-com-git-tips-tips"><a href="#详见-https-github-com-git-tips-tips" class="headerlink" title="详见 https://github.com/git-tips/tips"></a>详见 <a href="https://github.com/git-tips/tips" target="_blank" rel="external">https://github.com/git-tips/tips</a></h3>
      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/04/02/Git-Usage-Detail/" class="archive-article-date">
  	<time datetime="2016-04-02T10:00:00.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-04-02</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Git/">Git</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/Git/">Git</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-Git-Usage" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/02/Git-Usage/">Git 常用命令</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>以Github为例,介绍windows下 Git常用命令的使用</p>
</blockquote>
<ol>
<li><p>配置 SSH KEYS  (使用 ssh 协议的路径时需要, 使用http/https 无需配置)</p>
<ul>
<li>在 Git Bash中执行:  <code>ssh-keygen -t rsa -C &quot;youremail&quot;</code>   </li>
<li>此时会在当前用户根目录下生成.ssh文件夹，里面有两个文件：id_rsa , id_rsa.pub  </li>
<li>复制 ~/.ssh/id_rsa.pub 内容, 登陆github账户-&gt;Settings-&gt;SSH Keys-&gt; add , 粘贴,保存</li>
</ul>
</li>
<li><p>配置本机全局的用户名和邮箱( 可以设置不同的用户名)  </p>
<ul>
<li>全局的配置文件: /c/Users/username/.gitconfig</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git config --global user.name &quot;username&quot;</div><div class="line">git config --global user.email &quot;email&quot;</div></pre></td></tr></table></figure>
</li>
<li><p>基本操作命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">- git clone https://github.com/zengxp0605/test.git jason/test // 克隆一个远程的仓库到本地jason/test目录</div><div class="line">- git status  // 查看当前状态</div><div class="line">- git add filename // 添加单个文件</div><div class="line">- git add * // 或者使用git add -A , 添加所有更新的文件</div><div class="line">- git commit -am &quot;your message&quot; // 提交到本地仓库</div><div class="line">- git push &lt;远程主机名&gt; &lt;本地分支名&gt;:&lt;远程分支名&gt;</div><div class="line">- git push origin master // 推送到远程仓库, 简写: git push (没有默认匹配分支时无法简写)</div><div class="line">- git pull &lt;远程主机名&gt; &lt;远程分支名&gt;:&lt;本地分支名&gt;</div><div class="line">- git pull origin master   // 拉取更新, 简写: git pull </div><div class="line">- git pull origin next:master  // 取回origin主机的next分支，与本地的master分支合并</div><div class="line">- *.gitignore -&gt; 需要忽略，不需跟踪的文件或目录可以配置到此文件中,支持通配符*</div></pre></td></tr></table></figure>
</li>
<li><p>本地已有文件的目录需要初始化为git仓库时</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">- git init  // 初始化仓库</div><div class="line">- git remote add origin git@github.com:facebook/react-native.git  // 添加远程库origin 分支 </div><div class="line">- git remote -v   // 查看远程库,和分支</div><div class="line">- git remote remove origin  // 删除origin 分支</div></pre></td></tr></table></figure>
</li>
<li><p>关于分支</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">- git branch  // 查看本地分支， 带星号的为当前分支</div><div class="line">- git branch -a // 查看本地及远程分支</div><div class="line">- git branch testing  // 创建本地分支 testing </div><div class="line">- git checkout master  // 切换到master 分支</div></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="遇到的一些问题："><a href="#遇到的一些问题：" class="headerlink" title="遇到的一些问题："></a>遇到的一些问题：</h4><ol>
<li><p>git push/git pull 时提示需要加入远程和本地仓库地址</p>
<ul>
<li><p>方法1: 执行命令 (以下命令同时可以设置为 –global)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git config branch.master.remote origin</div><div class="line">git config branch.master.merge refs/heads/master</div></pre></td></tr></table></figure>
</li>
<li><p>方法2：修改 ~/.git/config 文件,添加以下行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[branch &quot;master&quot;]</div><div class="line">    remote = origin</div><div class="line">    merge = refs/heads/master</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ol>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/04/02/Git-Usage/" class="archive-article-date">
  	<time datetime="2016-04-02T09:00:00.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-04-02</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Git/">Git</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/Git/">Git</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-Sublime快捷键整理" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/02/Sublime快捷键整理/">Sublime text 3 常用快捷键</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="通用操作"><a href="#通用操作" class="headerlink" title="通用操作"></a>通用操作</h3><ol>
<li>撤销 (ctrl + z)<ul>
<li>需要取消撤销, 使用 ctrl + y</li>
</ul>
</li>
<li>重做 (ctrl + y)</li>
<li><p>复制 </p>
<ul>
<li>复制当前选中 ctrl + c</li>
<li><strong>复制当前行 (Shift + Ctrl + d)</strong><ul>
<li>Shift + Ctrl + d 可快速复制光标所在的一整行，并复制到该行之前。</li>
</ul>
</li>
</ul>
</li>
<li><p>粘贴 ctrl + v</p>
<ul>
<li>粘贴时保留缩进 ,使用Ctrl + Shift + V进行粘贴</li>
</ul>
</li>
<li><p>剪切当前行 Ctrl + X  </p>
<ul>
<li>删除整行 (Ctrl + Shift + K)</li>
</ul>
</li>
<li><p>查找替换功能：Ctrl + H</p>
</li>
<li><p>换行 / 快速添加新行</p>
<ul>
<li>Enter 普通换行 </li>
<li>Ctrl + Enter 可以在当前行下新建一行。</li>
<li>Ctrl + Shift + Enter 可以在当前行上面添加一行。</li>
</ul>
</li>
</ol>
<h3 id="快速查找"><a href="#快速查找" class="headerlink" title="快速查找"></a>快速查找</h3><ol>
<li>Goto Anything功能 （Ctrl + P）<ul>
<li>输入 @ + 函数名 可以快速找到函数。(相当于 ctrl+r)</li>
<li>输入 # + 文本 可以快速进行文件内文本匹配。</li>
</ul>
</li>
<li>Ctrl + F 查找文本</li>
</ol>
<h3 id="多行游标功能"><a href="#多行游标功能" class="headerlink" title="多行游标功能"></a>多行游标功能</h3><ol>
<li><p>启用多行游标（Ctrl + D，非常实用）</p>
<ul>
<li>如果有某些不想添加新行的模式则按Ctrl + K，Ctrl + D跳过这个进入下一个符合条件的模式行。</li>
</ul>
</li>
<li><p>还可以按Alt + F3快捷键全选所有符合条件的单词，产生多个光标，而不用一个个Ctrl + D选中</p>
</li>
<li>如果要在每行都加入光标，可以先Ctrl + A(或者鼠标选中某些行),然后Ctrl + Shift + L即可</li>
<li>多行游标的其他方式: <ul>
<li>Ctrl + alt + ↑ ↓</li>
<li>ctrl + 鼠标左键 ,在鼠标点击处开启多行游标</li>
<li>shift + 鼠标右键,滑动鼠标可以开启多行 </li>
</ul>
</li>
</ol>
<h3 id="移动-amp-选中"><a href="#移动-amp-选中" class="headerlink" title="移动&amp;选中"></a>移动&amp;选中</h3><ol>
<li><p>上下移动行/代码块 (Shift + Ctrl + ↑↓)</p>
<ul>
<li>定位光标或选中某块区域，然后按Shift + Ctrl + ↑↓可以上下移动该行。</li>
</ul>
</li>
<li><p><strong>选中花括号里面的全部内容不包括{}</strong></p>
<ul>
<li>Ctrl + Shift + M, 按多次可扩大选中范围</li>
<li>选括号内容同样适用</li>
</ul>
</li>
<li><p>快速选择单词, 跳过单词 (Shift + Ctrl +  ← →)/(Ctrl + 左右)/(Alt + 左右)</p>
<ul>
<li>按住Shift + Ctrl然后按←或→可快速选中一行中的某一部分，连续按扩大选择范围。</li>
<li>ctrl + ← → ,按\w规则移动（跳跃）</li>
<li>alt + ← → ,按单词移动</li>
</ul>
</li>
<li><p>选中单词,选中全部(alt+f3)</p>
<ul>
<li>alt+f3, ctrl + d, 相当于在当前单词开启多行游标</li>
</ul>
</li>
</ol>
<h3 id="跳转"><a href="#跳转" class="headerlink" title="跳转"></a>跳转</h3><ol>
<li><p>快速跳转到某一行 (Ctrl + G)</p>
<ul>
<li>按下Ctrl + G，输入行号，可以快速跳转到该行。</li>
</ul>
</li>
<li><p>跳转到对应括号 (ctrl + m)</p>
</li>
<li><p>书签, 设置后可以跳转</p>
<ul>
<li>ctrl + f2 ,设置书签</li>
<li>f2, 下一书签</li>
<li>shift + f2, 上一书签</li>
<li><strong>alt + f2 ,在设置的书签处启动多行游标(设置时光标所在列)</strong></li>
</ul>
</li>
<li><p>下一匹配项</p>
<ul>
<li>直接查找当前选中单词 (ctrl+f3)</li>
<li>已经处于查找状态, 按f3 到下一匹配, 或者回车键</li>
</ul>
</li>
</ol>
<h3 id="视图相关"><a href="#视图相关" class="headerlink" title="视图相关"></a>视图相关</h3><ol>
<li><p>切换视图</p>
<ul>
<li>ctrl+tab 栈中下一视图（打开顺序）</li>
<li>ctrl+shift+tab   栈中前一视图</li>
</ul>
</li>
<li><p><strong> Alt+Shift+1~9（非小键盘）屏幕显示相等数字的小窗口 </strong></p>
</li>
<li><p>重新打开关闭的标签 (Shift + Ctrl + T)</p>
<ul>
<li>在Chrome里面，如果你不小心关闭了某个标签页并想恢复它，你可以按下Shift + Ctrl + T重新打开它。</li>
<li>在ST3中也一样，如果你不小心关闭了某个文件，可以按下Shift + Ctrl + T快速恢复。连续重复该按键，ST将会按照关闭的先后顺序重新打开标签页。</li>
</ul>
</li>
</ol>
<h3 id="整理代码"><a href="#整理代码" class="headerlink" title="整理代码"></a>整理代码</h3><ol>
<li>折叠代码<ul>
<li>Ctrl+Shift+[ 折叠代码 </li>
<li>Ctrl+Shift+] 展开代码 </li>
<li>Ctrl+K+0 展开所有折叠代码。</li>
</ul>
</li>
<li><p>注释</p>
<ul>
<li>行注释 ctrl + /</li>
<li>块注释 ctrl + shift + /</li>
</ul>
</li>
<li><p>行排序(f9 || ctrl + f9)</p>
<ul>
<li>json 文件或者 css样式</li>
</ul>
</li>
<li><p>Ctrl+J 合并选中的多行代码为一行。举个栗子：将多行格式的CSS属性合并为一行。</p>
</li>
<li><p>大小写切换</p>
<ul>
<li>Ctrl+KU 改为大写 </li>
<li>Ctrl+KL 改为小写 </li>
</ul>
</li>
<li><p>F6 检测语法错误(貌似没啥用)</p>
</li>
<li><p>多行缩进</p>
<ul>
<li>选中多行后按Ctrl + ]可以增加缩进，按Ctrl + [可以减少缩进。</li>
<li>Tab和Shift + Tab也是可以的。</li>
</ul>
</li>
</ol>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><ol>
<li><p>html5 模板</p>
<ul>
<li>安装Emmet插件，直接在新建的html文件里（首先得设置语法模式为html）直接输入!（代表html5格式的html文档）然后按下tab即可。</li>
</ul>
</li>
<li><p><strong>切换侧边栏显示状态 (ctrl+k, ctrl+b)</strong></p>
</li>
<li><p>命令模式 (Ctrl + Shift + P)</p>
<ul>
<li>set syntax [language]设置为某种语言的语法模式(支持模糊匹配)</li>
<li>minimap隐藏或显示右边的minimap缩影 </li>
</ul>
</li>
</ol>
<h4 id="备注"><a href="#备注" class="headerlink" title="备注"></a>备注</h4><ul>
<li>粗体表示经常忘记的</li>
</ul>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/04/02/Sublime快捷键整理/" class="archive-article-date">
  	<time datetime="2016-04-02T09:00:00.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-04-02</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sublime/">sublime</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/IDE/">IDE</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-2-Node-mysql_transaction_promise" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/01/2-Node-mysql_transaction_promise/">nodejs中mysql异步事务的几点思考</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="说明"><a href="#说明" class="headerlink" title="说明:"></a>说明:</h4><ul>
<li>mysql 只在启动node 时,初始化一次连接, 通过 <code>global.app.set(&#39;db.test&#39;, mysqlConn)</code> 存储, 获取使用 <code>app.get(&#39;db.test&#39;)</code>;</li>
<li>所有的测试都是基于socket连接发送 emit 命令来执行的 </li>
<li>测试只使用一个<code>test</code> 表,同时当做日志表使用,</li>
<li><code>test</code> 表结构如下:    <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">CREATE TABLE `test` (</div><div class="line">  `id` int(11) NOT NULL AUTO_INCREMENT COMMENT &apos;自增长ID&apos;,</div><div class="line">  `user_id` int(11) unsigned NOT NULL COMMENT &apos;不允许为NULL,NULL 报错&apos;,</div><div class="line">  `title` varchar(100) NOT NULL DEFAULT &apos;&apos; COMMENT &apos;title&apos;,</div><div class="line">  `content` varchar(500) NOT NULL DEFAULT &apos;&apos; COMMENT &apos;content&apos;,</div><div class="line">  `update_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT &apos;自动更新时间&apos;,</div><div class="line">  PRIMARY KEY (`id`)</div><div class="line">) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT=&apos;test&apos;;</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="使用原始的回调写法"><a href="#使用原始的回调写法" class="headerlink" title="使用原始的回调写法"></a>使用原始的回调写法</h3><ol>
<li>只执行两条sql语句(事务A), 例子来自 <a href="https://www.npmjs.com/package/mysql#transactions" target="_blank" rel="external">node-mysql模块</a></li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line">test.trans = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> connection = app.get(<span class="string">'db.test'</span>);</div><div class="line"></div><div class="line">    connection.beginTransaction(<span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</div><div class="line">      <span class="keyword">if</span> (err) &#123; <span class="keyword">throw</span> err; &#125;</div><div class="line">      <span class="keyword">var</span> data1 = &#123;</div><div class="line">        <span class="attr">user_id</span> : <span class="number">111</span>,</div><div class="line">        <span class="attr">title</span>: <span class="string">'insert'</span>,</div><div class="line">      &#125;;</div><div class="line">      connection.query(<span class="string">'INSERT INTO test SET ?'</span>, data1 , <span class="function"><span class="keyword">function</span>(<span class="params">err, result</span>) </span>&#123;</div><div class="line">        <span class="keyword">if</span> (err) &#123;</div><div class="line">          <span class="keyword">return</span> connection.rollback(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="built_in">console</span>.log(<span class="string">'rollback0, 部分失败!'</span>, err);</div><div class="line">          &#125;);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">var</span> data2 = &#123;</div><div class="line">            <span class="attr">user_id</span> : <span class="number">222</span>,</div><div class="line">            <span class="comment">//user_id : null, // 此时将触发回滚</span></div><div class="line">            title: <span class="string">'Log:'</span>, </div><div class="line">            <span class="attr">content</span>: result.insertId + <span class="string">' added'</span>,</div><div class="line">        &#125;;</div><div class="line"></div><div class="line">        <span class="comment">/***********代码段1 start***************/</span></div><div class="line">        connection.query(<span class="string">'INSERT INTO test SET ?'</span>, data2, <span class="function"><span class="keyword">function</span>(<span class="params">err, result</span>) </span>&#123;</div><div class="line">          <span class="keyword">if</span> (err) &#123;</div><div class="line">            <span class="keyword">return</span> connection.rollback(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">                <span class="built_in">console</span>.log(<span class="string">'rollback1, 部分失败!'</span>, err);</div><div class="line">            &#125;);</div><div class="line">          &#125;  </div><div class="line">          connection.commit(<span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</div><div class="line">            <span class="keyword">if</span> (err) &#123;</div><div class="line">              <span class="keyword">return</span> connection.rollback(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">                  <span class="built_in">console</span>.log(<span class="string">'rollback2, 部分失败!'</span>, err);</div><div class="line">              &#125;);</div><div class="line">            &#125;</div><div class="line">            <span class="built_in">console</span>.log(<span class="string">'All success!'</span>);</div><div class="line">          &#125;);</div><div class="line">        &#125;);</div><div class="line">        <span class="comment">/***********代码段1 end***************/</span></div><div class="line"></div><div class="line">      &#125;);</div><div class="line">    &#125;);</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<ol>
<li>将上述的代码段1 修改为下面的语句, 批量insert, 但是只有最后一次才提交<ul>
<li>目的是为了制造延时较长时间才执行 commit 或者 rollback</li>
</ul>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">var</span> i = <span class="number">15</span>;</div><div class="line"><span class="keyword">while</span>(i &gt;= <span class="number">0</span>)&#123;</div><div class="line">    (<span class="function"><span class="keyword">function</span>(<span class="params">_i</span>)</span>&#123;</div><div class="line">        setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"></div><div class="line">            data2.user_id = _i;</div><div class="line">            connection.query(<span class="string">'INSERT INTO test SET ?'</span>, data2, <span class="function"><span class="keyword">function</span>(<span class="params">err, result</span>) </span>&#123;</div><div class="line">                <span class="keyword">if</span> (err) &#123;</div><div class="line">                    <span class="keyword">return</span> connection.rollback(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">                        <span class="built_in">console</span>.log(<span class="string">'rollback1, 部分失败!'</span>, err);</div><div class="line">                    &#125;);</div><div class="line">                &#125;  </div><div class="line"></div><div class="line">                <span class="comment">// 只有最后一次才commit</span></div><div class="line">                <span class="keyword">if</span>(_i != <span class="number">15</span>) <span class="keyword">return</span> <span class="literal">null</span>; </div><div class="line">                </div><div class="line">                connection.commit(<span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</div><div class="line">                    <span class="keyword">if</span> (err) &#123;</div><div class="line">                        <span class="keyword">return</span> connection.rollback(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">                            <span class="built_in">console</span>.log(<span class="string">'rollback2, 部分失败!'</span>, err);</div><div class="line">                        &#125;);</div><div class="line">                    &#125;</div><div class="line">                    <span class="built_in">console</span>.log(<span class="string">'All success!'</span>);</div><div class="line">                &#125;);</div><div class="line"></div><div class="line">            &#125;);</div><div class="line">        &#125;, <span class="number">1000</span> * _i); <span class="comment">// 延时一直递增</span></div><div class="line">    &#125;)(i);</div><div class="line"></div><div class="line">    i --;</div><div class="line">&#125; <span class="comment">// end while</span></div></pre></td></tr></table></figure>
<ul>
<li>并且此时, 在上面的语句还没有commit 的时候, 另一个socket 连接执行了下面的代码(事务B),那么会造成什么后果呢?</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">test.insert = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> connection = app.get(<span class="string">'db.test'</span>);</div><div class="line"></div><div class="line">    connection.beginTransaction(<span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</div><div class="line">        <span class="keyword">if</span> (err) &#123; <span class="keyword">throw</span> err; &#125;</div><div class="line">        <span class="keyword">var</span> data1 = &#123;</div><div class="line">            <span class="attr">user_id</span> : <span class="number">3333</span>,</div><div class="line">            <span class="attr">title</span>: <span class="string">'insert 333'</span>,</div><div class="line">        &#125;;</div><div class="line">        connection.query(<span class="string">'INSERT INTO test SET ?'</span>, data1 , <span class="function"><span class="keyword">function</span>(<span class="params">err, result</span>) </span>&#123;</div><div class="line">            <span class="built_in">console</span>.log(<span class="string">'test.insert: '</span> + result.insertId);</div><div class="line">            </div><div class="line">            <span class="comment">/***********代码段2 start***************/</span></div><div class="line">            <span class="comment">// connection.rollback();</span></div><div class="line">            connection.commit(<span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</div><div class="line">                <span class="keyword">if</span> (err) &#123;</div><div class="line">                    <span class="keyword">return</span> connection.rollback(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">                        <span class="built_in">console</span>.log(<span class="string">'rollback2, 部分失败!'</span>, err);</div><div class="line">                    &#125;);</div><div class="line">                &#125;</div><div class="line">                <span class="built_in">console</span>.log(<span class="string">'All success!'</span>);</div><div class="line">            &#125;);</div><div class="line">            <span class="comment">/***********代码段2 end***************/</span></div><div class="line"></div><div class="line">        &#125;);</div><div class="line">        </div><div class="line">    &#125;); </div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<ul>
<li><p><strong> 此时后面的事务将直接将前面while循环中已经<code>query</code> 的语句都提交并执行掉, while循环中未完成的<br>则将不在事务中 </strong></p>
</li>
<li><p>此时如果注释掉 代码段2(commit) 部分, 事务A 中已经 <code>query</code> 的语句都提交并执行掉, 未执行的则在新的事务中,等待下次提交</p>
</li>
<li><p>若是 代码段2(commit) 部分改成 <code>connection.rollback();</code> 将会触发事务A 提交, while 未执行的语句将是普通执行的语句,不在事务中</p>
</li>
<li><p><strong> 事务B 直接提交了事务A!!! 这个一开始一直没有理解怎么回事???<br>后来想想,node是单线程的, 但是这里都是在不同的回调函数中,应该也是在不同的子线程中执行的,<br>为什么会出现这个情况呢?</strong></p>
</li>
</ul>
<h3 id="通过测试-发现问题在于数据库连接-使用的都是同一个连接"><a href="#通过测试-发现问题在于数据库连接-使用的都是同一个连接" class="headerlink" title="通过测试,发现问题在于数据库连接, 使用的都是同一个连接!!!!!"></a>通过测试,发现问题在于数据库连接, 使用的都是同一个连接!!!!!</h3><p>囧!!!!</p>
<hr>

<h3 id="MySql-事务相关知识"><a href="#MySql-事务相关知识" class="headerlink" title="MySql 事务相关知识"></a>MySql 事务相关知识</h3><ol>
<li><p>锁:    </p>
<ul>
<li><p>锁的机制</p>
<ul>
<li>共享锁：由读表操作加上的锁，加锁后其他用户只能获取该表或行的共享锁，不能获取排它锁，也就是说只能读不能写</li>
<li>排它锁：由写表操作加上的锁，加锁后其他用户不能获取该表或行的任何锁，典型是mysql事务中</li>
</ul>
</li>
<li><p>锁的范围</p>
<ul>
<li>行锁: 对某行记录加上锁</li>
<li>表锁: 对整个表加上锁</li>
</ul>
</li>
</ul>
</li>
<li><p>什么是事务   </p>
<ul>
<li>事务是一条或多条数据库操作语句的组合，具备ACID，4个特点。</li>
<li>原子性：要不全部成功，要不全部撤销</li>
<li>隔离性：事务之间相互独立，互不干扰</li>
<li>一致性：数据库正确地改变状态后，数据库的一致性约束没有被破坏</li>
<li>持久性：事务的提交结果，将持久保存在数据库中</li>
</ul>
</li>
<li><p>事务级别    </p>
<ul>
<li>各种事务级别的简述  </li>
</ul>
<p>| 隔离级别                           |   脏读  |   不可重复读   |   幻读  |   加锁读  |<br>| ———————————- | ——- | ————– | ——- | ——— |<br>| READ UNCOMMITTED(读取未提交内容)   |   是    |   是           |   是    |   否      |<br>| READ COMMITTED (读取提交内容)      |   否    |   是           |   是    |   否      |<br>| REPEATABLE READ  (可重读)          |   否    |   否           |   是    |   否      |<br>| SERIALIZABLE  (可串行化)           |   否    |   否           |   否    |   是      |</p>
</li>
</ol>
<ul>
<li>名词解释:    <ul>
<li>第一类丢失更新：在没有事务隔离的情况下，两个事务都同时更新一行数据，但是第二个事务却中途失败退出， 导致对数据的两个修改都失效了。</li>
<li>脏读：脏读就是指当一个事务正在访问数据，并且对数据进行了修改，而这种修改还没有提交到数据库中，这时，另外一个事务也访问这个数据，然后使用了这个数据。</li>
<li>不可重复读：是指在一个事务内，多次读同一数据。在这个事务还没有结束时，另外一个事务也访问该同一数据。那么，在第一个事务中的两次读数据之间，由于第二个事务的修改，那么第一个事务两次读到的的数据可能是不一样的。这样就发生了在一个事务内两次读到的数据是不一样的，因此称为是不可重复读。</li>
<li>第二类丢失更新：不可重复读的特例。有两个并发事务同时读取同一行数据，然后其中一个对它进行修改提交，而另一个也进行了修改提交。这就会造成第一次写操作失效。</li>
<li>幻读：是指当事务不是独立执行时发生的一种现象，例如第一个事务对一个表中的数据进行了修改，这种修改涉及到表中的全部数据行。同时，第二个事务也修改这个表中的数据，这种修改是向表中插入一行新数据。那么，以后就会发生操作第一个事务的用户发现表中还有没有修改的数据行，就好象发生了幻觉一样。<blockquote>
<p>不可重复读的重点是修改，同样的条件，你读取过的数据，再次读取出来发现值不一样了<br>幻读的重点在于新增或者删除，同样的条件，第 1 次和第 2 次读出来的记录数不一样<br><strong> Mysql默认的事务隔离级别为repeatable_read </strong></p>
</blockquote>
</li>
</ul>
</li>
</ul>
<ol>
<li><p>修改事务级别设置  </p>
<ul>
<li><p>全局修改，修改mysql.ini配置文件，在最后加上</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">#可选参数有：READ-UNCOMMITTED, READ-COMMITTED, REPEATABLE-READ, SERIALIZABLE.</div><div class="line">[mysqld]</div><div class="line">transaction-isolation = REPEATABLE-READ</div></pre></td></tr></table></figure>
</li>
<li><p>对当前session修改，在登录mysql客户端后，执行命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">// 设置</div><div class="line">mysql&gt; set session transaction isolation level read uncommitted;</div><div class="line">// 查看</div><div class="line">mysql&gt; select @@TX_ISOLATION;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ol>
<p>4.参考:  </p>
<ul>
<li>锁和事务级别, <a href="http://www.cnblogs.com/zemliu/archive/2012/06/17/2552301.html" target="_blank" rel="external">http://www.cnblogs.com/zemliu/archive/2012/06/17/2552301.html</a><blockquote>
<p>文章通过实例详述了 READ-UNCOMMITTED, READ-COMMITTED, REPEATABLE-READ, SERIALIZABLE 四种隔离级别时出现的现象  </p>
</blockquote>
</li>
</ul>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/04/01/2-Node-mysql_transaction_promise/" class="archive-article-date">
  	<time datetime="2016-04-01T14:33:57.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-04-01</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysql/">mysql</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/nodejs/">nodejs</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/nodejs/">nodejs</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-template-md" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/04/01/template-md/" class="archive-article-date">
  	<time datetime="2016-04-01T14:33:57.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-04-01</time>
</a>
      
      

      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-windows-cmd" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/15/windows-cmd/">windows下常用cmd命令</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="windows-下杀死进程"><a href="#windows-下杀死进程" class="headerlink" title="windows 下杀死进程"></a>windows 下杀死进程</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">netstat -aon  // 查看端口情况</div><div class="line">netstat -aon | findstr &quot;8080&quot;  // 查看对应端口的pid</div><div class="line"></div><div class="line">tasklist | findstr &quot;7612&quot; // 查看pid=7612 的进程名称</div><div class="line"></div><div class="line">taskkill /im /f node.exe   // 强制停止 node.exe 进程</div></pre></td></tr></table></figure>
<h2 id="一些常用命令"><a href="#一些常用命令" class="headerlink" title="一些常用命令"></a>一些常用命令</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">nslookup google.com.hk 8.8.8.8 //查询 google.com.hk 的ip,( 8.8.8.8 是DNS 服务器)</div><div class="line"></div><div class="line">// 列出文件目录树形结构</div><div class="line">tree </div><div class="line">tree /f</div><div class="line">// 导出到文件</div><div class="line">tree /f &gt; d:/tree.txt</div></pre></td></tr></table></figure>
<h2 id="Usage"><a href="#Usage" class="headerlink" title="  Usage"></a>  Usage</h2><h3 id="Key-Bindings"><a href="#Key-Bindings" class="headerlink" title="Key Bindings"></a>Key Bindings</h3><p>  The default key bindings:</p>
<p>  <strong>Windows, Linux:</strong></p>
<ul>
<li><kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>O</kbd>: Preview Markup in Browser.</li>
<li><kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>X</kbd>: Export Markup as HTML.</li>
<li><p><kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>C</kbd>: Copy Markup as HTML.</p>
<p><strong>OSX:</strong></p>
</li>
<li><p><kbd>⌘</kbd>+<kbd>⌥</kbd>+<kbd>O</kbd>: Preview Markup in Browser.</p>
</li>
<li><kbd>⌘</kbd>+<kbd>⌥</kbd>+<kbd>X</kbd>: Export Markup as HTML.</li>
<li><kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>C</kbd>: Copy Markup as HTML.</li>
</ul>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/03/15/windows-cmd/" class="archive-article-date">
  	<time datetime="2016-03-15T14:33:57.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-03-15</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/windows/">windows</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/windows/">windows</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-english-music-top100" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/15/english-music-top100/">世界上排名前100的英文歌</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><em>转载自: <a href="http://www.jianshu.com/p/2bce2d6339f9" target="_blank" rel="external">简书</a></em></p>
<ol>
<li><p>don’t cry–guns n’ roses 这首歌曾唱哭了千万人。总是能够触痛了心底最软的地方，心抽痛着,眼圈红了，却没有眼泪渗出，每多听一次就多一次的依恋…</p>
</li>
<li><p>fade to black–ＭＥＴＡllic 金属乐队也有很经典歌曲,相信国内有好多人都是听了这首歌的前奏才去学吉他的!ＭＥＴＡLLICA经典中的经典,也是ＭＥＴＡLLICA饱受争议的作品,因为当时有乐迷自杀就是出于这首歌，胆小别听哦~</p>
</li>
<li><p>dreaming my dream–cranberries 有着王菲一样变幻倚俪的唱腔，高雅离开了原本浩渺的苍穹来到人间，它带着冷漠的美艳，但又说着人身上的变动和永恒，爱尔兰的卡百利乐队就这样汲取了精灵与传说的浩渺气质，沟通了人间和天空的美，把人的故事，爱情，历史，死亡，社会都融进那飘忽而真切的女声中…(卡百利，本是蔓声浆果的藤蔓)</p>
</li>
<li><p>dying in the sun–cranberries 不断地重复着放这首歌,简短迂回的旋律,简短迂回的歌词。平躺在这样的歌里,晕乎乎的,渴望在阳光下睡死…</p>
</li>
<li><p>never grow old–cranberries 最近常听朋友们说时间过得好快~! 感觉自己在一天一天的虚度光阴! 不由得想起了这支歌~!</p>
</li>
<li><p>far away from home–groove coverage 德国新晋乐队,这首歌已被众多知名DJ誉为当今舞曲最为精华的传世之作，听了不下几百遍了，旋律好的很，女声好的很…</p>
</li>
<li><p>knocking on heaven’s door–guns n’ roses (“野蛮师姐”主题曲)艾薇儿翻唱的和q1an9花版的都给人一种爽歪的感觉，当然女生版的更加恬静，睡觉之前是要听的奥。</p>
</li>
<li><p>imagine–john lennon 约翰列侬是全世界最成功的摇滚乐队“甲壳虫”（或叫披头士）(beatles)的灵魂人物，死于1980年12月8日，是被一名狂热的歌迷开q1an9打死的，他的死震惊了世界，他在六十年代.，目无宗教和governme-nt，在七十年代致力研究东方宗教和宣扬童话般的爱(有一颗小星星是以他的名字命名的)，这声音听来象预言者的祈祷，而歌词依然是固执的理想，或许列侬所要求的泰国绝对，太过纯洁，但作为梦，难道你我就不曾有过吗？</p>
</li>
<li><p>yesterday–beatles 这么经典的还说什么呢，电台点播率已经超过一亿次了，没听过的太逊了…..</p>
</li>
<li><p>let it be–beatles 昔日创下了榜史纪录,也是Beatles解散时成员们的心态写照。有时候生命的意义在于过程,至于结果就让它Let it be…</p>
</li>
<li><p>it’s my life–bon jovi 曾用来做CS的MTV背景音乐。</p>
</li>
<li><p>that’s why(you go away)–meachael learns to rock 半路在一家美发店的门前听到了that’s why (you go away)的钢琴版!!! 感觉很好,这样听起来That’s why就更经典了! (放的声音越大越有感觉哦)</p>
</li>
<li><p>you can’t say (韩剧’爱上女主播’主题曲)相信大家对这首歌不会感到陌生了哦!!!每当旋律一起就能体会其中的柔情…</p>
</li>
<li><p>yesterday yes a day 温柔醇厚的声音,静静地用心体会,很舒服的21岁的挪威女孩marlin,自己写歌自己唱,一首充满浪漫气息的法国歌曲,就像爱人在你耳 边轻轻呢喃,超好听的…</p>
</li>
<li><p>heal the world–meachael kjackson 他是疯狂热爱和不羁职责的承受者，年轻的巨富，心理怪异而各声纯洁的奇人，他富于创造，不向任何一个流派*拢，虽然,杰克逊现在的形象不好,但他曾经为世界的慈善事业作了很大的贡献,这首歌也正是他心意的表现吧…最起码他在音乐方面的高度是谁都无法否认的。</p>
</li>
<li><p>the girl is mine–meachael jackson. 纯洁的仿佛童话，干净的让人不敢呼吸…</p>
</li>
<li><p>delicious way–仓木麻衣。 我本人也十分仇恨日本人的，但是听到这么纯洁的歌曲感觉到音乐真的是没有国界的哎~~</p>
</li>
<li><p>under the sea 小美人鱼(the little mermaid)插曲,可总感觉张邵晗唱的更有活力。再听听原唱的，就知道东西方文化的差异在哪里了。</p>
</li>
<li><p>fighter–Christina 厚重有力的嗓音穿透着我的耳膜,装饰着闪亮碎钻的眼眸冲击着我的视网膜…希望有一天,我能够成为那个fighter… 蛮有爆发力的一首歌。</p>
</li>
<li><p>without you–mariah carey 我喜欢的歌星！因为她在唱功方面显得极为细腻,而且她的声线真的是迷人而且非常有爆发力和感染力…这是高音上唯一可与i will always love you媲美的歌，下面还有一首两人合唱的，绝对体现唱功哦~~</p>
</li>
<li><p>when you believe–mariah carey n’ whitney houston 不多说了，任何人都唱不成这样的。</p>
</li>
<li><p>Crying in the Rain 大概算的上是欧美最具生命力的情歌之一了，这首出自民谣女歌手Carole King的作品对原来舒缓深情的作品来了一次颠覆性的改造…</p>
</li>
<li><p>never say goodbye–Hayley Westenra 充满曼陀铃和竖琴声音的歌曲当中透显出一个宁静而美丽的少女形象，歌曲是从爱尔兰传统歌曲中改编过来，Hayley Westenra的声音如同丝线一般，在演唱技巧上更已达到完美的境地，而嗓音天生的优美更是让人不得不赞叹和艳羡。</p>
</li>
<li><p>Sugar Ray’s Someday。 Sugar Ray(据说应该翻译作“拔丝”乐队-_-bbb)，他们的音乐风格用一个字就可以形容——Summer，他们只在夏天出片，歌儿一听就让人想起夏天——总是阳光明媚、活泼愉快。与此相反的，他们的歌词却是比较深的，那个身上有着13个纹身、英俊得完全不像个rock band主唱的Mark McGrath经常用很夸张的肢体语言在MTV中摇摆，加上十分十分正宗的传统摇滚式配器，恐怕在今天活着的乐队中找不出第二个这样的band。</p>
</li>
<li><p>Iris– Goo Goo Dolls 清脆急促的吉他solo，John Rzeznik饱含沧桑的低沉嗓音，对世事、爱情满腹的疑问，后面的爆发，“And I don’t want the world to see me, ‘Cause I don’t think that they’d understand. When everything’s made to be broken, I just want you to know who I am!” 这是有着无穷韵味的箴言。</p>
</li>
<li><p>Mystical Machine Gun–Kula Shaker比较难得的是，Kula Shaker的音乐受了很多东方思想的影响，这一点同时表现在歌词、音乐和配器之中。乐队唯一真正意义上的专辑就是《Peasants, Pigs &amp; Astronauts》专辑干净的声音，迷幻的吉他，如印度梵音般的和声，充满现场感的录音，总之在当时背景下，属于绝对的异类。</p>
</li>
<li><p>Elemental–tears for fears.其实只是主唱oland Orzab一个人而已，整张专辑所有词曲、每一轨录音(器乐、主唱、和声)全部出自这家伙一人之手(口)，真是吓了一跳(原来世界上真的有全才啊)！</p>
</li>
<li><p>gone away–the off spring是一个比较有争议的乐队。跟99%的美国摇滚乐队一样，也是来自学校同学的组合，经过很长时间的地下活动，终于走到地上，给人留下最深刻印象就是主唱Bryan Holland的十分金属化的硬朗狂放的唱腔,歌词有着对世事无情的玩弄和嘲讽。</p>
</li>
<li><p>A Question Of Lust–peche Mode很容易和“冷”这个字联系起来，冷冰冰的纯电子音乐，冷冷的唱腔，冷僻的歌词，似乎特别适合目前这个季节来听…</p>
</li>
<li><p>this is how we do it蛮欢快的一首现代英文混音dj舞曲，偶个人比较喜欢。</p>
</li>
<li><p>boom boom boom各位爱跳舞的朋友，这就是你们的音乐，做为音乐和舞蹈的信徒，你们起床要放的音乐。</p>
</li>
<li><p>Earth song–meachael jackson请保护大自然!~ 崇高的敬意!~ 看过mv后真的感觉心里堵堵的…</p>
</li>
<li><p>everybody dance now相信看过韩国综艺节目情书的朋友不会陌生吧~里面好多背景音乐就是用的这个，尤其是uncle shin的抖动dance甩你的双手，很简单的一个步骤，音乐炸进你的头，活着就要开心些嘛！！！顺便说一下， 我超级喜欢那个张英兰~~~~</p>
</li>
<li><p>the day you went away–M2M是当之无愧的小甜甜咯，相信谁都不会忍心伤害这样的女生，不过歌词有点伤感，我们从来都不知道珍惜所拥有的直到永远的失去它,将如何承受这种痛苦,现在，我不得不说，我是真的真的失去了你…</p>
</li>
<li><p>when you say nothing at all–Krauss多次被评为世界最美的女声,坐拥11座格莱美奖,被无数人翻唱过… 男孩地带的也同样也是不可错过的哦！</p>
</li>
<li><p>hero–enrique iglesias出生在马德里,有着西班牙人独有的深邃的双眸,冷峻而又的脸庞,富有磁性的嗓音,再加上他那令人神魂颠倒的外表…</p>
</li>
<li><p>god is a girl–groove coverage从个人角度看sweetbox和groove coverage是给我印象最深的两个女唱乐队，下面还有几首歌都是她们的，很喜欢女主唱有些慵懒而很清脆的声音,他们的风格…喜欢听这种节奏感强，比较热闹的歌曲。觉得这个乐队的风格还是挺新鲜的，也比较大众化，应该会有不少朋友会喜欢，因为大众不等于庸俗。</p>
</li>
<li><p>she–groove coverage</p>
</li>
<li><p>can’t get over you–groove coverage</p>
</li>
<li><p>7 years and 50 days–groove coverage</p>
</li>
<li><p>encore une fois–helene segara一首抒情法语歌,哀而充满无奈的歌,你能体会到它的忧伤,也许有一天 我会离开你,途跋涉寻找真的自己也许有一天…也许有一天…</p>
</li>
<li><p>je m appelle helene–helene rolls听了首法语歌后觉得法语太美了,让人感觉说法语的人嘴上摸了奶油,…于记忆深处,要我找到简单的爱情,于我的爱情,歌词中有着淡淡的伤感…</p>
</li>
<li><p>here i am–bryan adams那是布赖恩亚当斯的作品,我想大家应该都听过他那首绝对经典的歌“( Everything I Do )吧，这个帅帅的沧桑男人的声音是谁都无法抗拒的哦。</p>
</li>
<li><p>Everything i do–bryan adams不多说了，绝对经典中的经典。</p>
</li>
<li><p>with or without you–毫无疑问,U2是80年代英国最受欢迎的摇滚乐团,不过我个人只喜欢这一首，具体也说不出为什么，可能感觉声音和旋律搭配的很棒吧~~</p>
</li>
<li><p>big big world–Emilia看上去是一个爱整洁的乖女孩,尤其在唱“Big,Big World”这样的慢歌时,她显得十分纯情而古典。目前Emilia的唱片在瑞典已卖过了3白金的数量。而首支单曲“Big,BigWorld”则成为了瑞典历史上流行速度最快的一支…</p>
</li>
<li><p>right here waiting–rachard max这是一首很经典的老歌,歌唱了刻骨铭心的爱情… 这是我曾经最爱的一首老歌,相信每个人也都听过无数遍,但依然是…</p>
</li>
<li><p>stay–williams(野蛮师姐主题曲)特别特别特别的欢快，每次不知道为了什么一心烦就不由自主想听这首歌,连我们宿舍一个平时不怎么愿意听歌的哥们也喜欢上了这首…</p>
</li>
<li><p>live forever–Oasis 是近十年来英国最受欢迎和最受评论家承认的乐队之一;live forever是我朋友推荐给我的，听过后感觉真的很不错呢…</p>
</li>
<li><p>life for rent–dido清爽的时节,清爽的女孩儿,清爽的音乐。Life for rent，把整个生命都出租出去，不属于任何人，无根地飘荡，听起来有一些伤感。</p>
</li>
<li><p>promise don’t come easy跟着CD慢慢的哼着，记不清楚是什么时候第一次听了，若有若无的思绪缠绕着自己，象梦一样。</p>
</li>
<li><p>lonely–nana是一首黑人说唱歌曲,同时加入了R&amp;B和Blues的曲风,歌曲的当中还有女声的伴唱,旋律非常优美。不会再有第二首歌可以超越…歧视,家庭的破碎…</p>
</li>
<li><p>dilemma–kellyrowland与饶舌巨星nelly搭档演唱的歌曲，这首歌曲虽然风格老套，但仍然在全美电台创下近两个月蝉联冠军宝座的纪录。</p>
</li>
<li><p>you took my heart away舒缓的节奏，简洁的编曲，十足的优美旋律，都展现了mltr最擅长的迷人功力。</p>
</li>
<li><p>helene segara-encore une fois一首经典法语歌，同样将法国浓郁的浪漫气息，法国当红歌手helene segara 专辑,她的音乐和她的人一样别有风情。她的嗓音并不是十分突出，但声音中有一种魅惑迷离的特质。</p>
</li>
<li><p>sealed with a kiss 以吻封缄，经典美国乡村音乐，一首极具浪漫色彩的老歌，叙离别情，但不伤感；道分手苦，但不低沉。饱尝相思之苦的恋人们听来，肯定别有一番滋味…</p>
</li>
<li><p>only time–enya无由的哀愁随着Only Time的歌声涌上心头。而当爱情灭绝﹑心泣莫名﹑欲盖弥彰的绝望凄清，却只有时间为唯一的目击者…</p>
</li>
<li><p>i will be missing you记得第一次听它的时候，只记得旋律很HIP-POP，直到后来无意中才知道了它的来历。于是找来下载，听，一遍又一遍。</p>
</li>
<li><p>civil war–guns n’ roses在美国这样一个国度，一支摇滚乐队创作出这样一首忧国忧民(当然也可以理解成激愤)的歌曲，这不是对摇滚乐的反判，恰恰是对摇滚更好的诠释。我想，摇滚乐在国外之所以有那么高的地位正是由于国外的很多摇滚乐队有着对社会、对国家的主人精神以及对音乐的深入理解和精彩绝伦的演绎。国内呢？只有流行乐泛滥罢了，摇滚不光是非主流，几乎成末流了…悲哀啊…</p>
</li>
<li><p>sunny came home1998年葛莱美大奖获奖作品,现在已很难找得到这样动听的旋律了.</p>
</li>
<li><p>the one–Mr big每首歌曲中都有一段经典耐听的吉他SOLO。我想有这一首歌就足以流芳百世了,即使多少年以后,这首歌也会引起人们无限的共鸣。</p>
</li>
<li><p>to be with you–Mr big几乎所有的吉他教材都可以看到这首《与你同在》，这首歌用木吉他超越了轰鸣，用随便超越了夸张，用一群拍着首合唱的小伙子超越了舞台上的超级巨星…时间总会流逝，浪漫和现实，究竟哪一个会与你同在呢？</p>
</li>
<li><p>stop crying your heart out–oasis称不上经典，但是也总能给人一种疲倦到不想说什么的地步，如过明天我死了…</p>
</li>
<li><p>cinderella太鄙视SHE的媚日情节，所以只好听英文版的这首半糖主义，不过发现比她们唱的好听一百倍！！！</p>
</li>
<li><p>the sound of silence是奥斯卡最佳电影《毕业生》的主题歌,是美国流行音乐大师保罗西蒙的代表…我相信，一百个人当中会有一百个人喜欢听这歌的。</p>
</li>
<li><p>should it matter–sissel kyrkjeb我喜欢这个低调又华美的女子,淡淡的感觉，仔细听可以听出哦！</p>
</li>
<li><p>stuck in my heart旋律很优美，中间有一段很完美的合声。</p>
</li>
<li><p>utopia–sweetbox下面三首歌都是出自sweetbox的，丢失了以后心疼到现在呢，哪位哥哥姐姐能知道哪里下的到一定告诉小弟哦，谢谢咯！！！他们的歌曲都巧妙地融合Pop、搖滾音乐，行雲流水的律动帶出女主唱Jade戏剧性的歌声，不仅开启歌迷的想像空间，而且扣人心弦，真的不动心都不行啊…</p>
</li>
<li><p>alright–sweetbox</p>
</li>
<li><p>one kiss–sweetbox</p>
</li>
<li><p>dreams come true–sens被无数个电台做过无数次的背景电乐，旋律响起你就知道你肯定听过的…</p>
</li>
<li><p>sweet dream很喜欢的一首歌了,张娜拉长的实在是太可爱了,有条件的朋友可以去找下这个MV看下,相当不错哦~~</p>
</li>
<li><p>back to you–bryan adams不多说了，布莱恩.亚当斯的每一首歌都那么经典…</p>
</li>
<li><p>forever and ever-because i love you。绝对好听，因为dido就是因为这首歌红的。</p>
</li>
<li><p>Say It Isn’t So–bon jovi硬汉唱的柔情歌曲也蛮感人的嘛~~</p>
</li>
<li><p>now and forever–richard max可能大家很少听他的歌吧<code>~</code>其实他的歌真的很不错！希望能和大家一起分享啊！</p>
</li>
<li><p>angle of mine一个很老的乐队唱的,具体名字我忘了,超好听。</p>
</li>
<li><p>dream cranberries就是大名鼎鼎的卡百利乐队 …这首《Dream》选自他们第一张专辑 王菲曾经翻唱过,翻唱得…我都听不出真假…可惜每次出去唱王菲的歌都感觉在糟蹋音乐哎~~</p>
</li>
<li><p>faint–lincoln park林肯公园,乐队名字是因为每天乐队的例行练习结束回家时,他都会驾车路过林肯公园,重要的是,他们的平均年龄不过二十出头哦…他们的音乐给人蛮另类的感觉</p>
</li>
<li><p>somewhere i belong–lincoln park节奏蛮快然后有点另类的歌。</p>
</li>
<li><p>meredith brooks开朗轻快的曲风很讨人喜欢，名字(妖精)是不好听了一点点，但整首歌却是有一点我行我素，特立独行并不会为任何人改变。</p>
</li>
<li><p>westlife有一段时间,很喜欢Westlife的歌,每天在他们的歌声中吃饭，看书，入睡。 </p>
</li>
<li><p>the power of love–celion dion提起席琳迪翁(Celine Dion),大家都知道她的演唱以倾情投入而闻名于世,她的音色极具表现力,声域宽广，很有张力，最喜欢的歌曲,，完美的歌曲。</p>
</li>
<li><p>a new day has come–celion dion她以满腔的爱与希望蕴育出另一个炽热的生命，她歌唱生涯中第八张英文专辑「a new day has come真爱来临」，在细腻悠扬、情感丰沛的歌声中，感受到旺盛的生命能量，热烈地传送到世界每个角落。</p>
</li>
<li><p>more than word*–extreme被翻唱了无数遍的歌，只用一把木吉他伴奏，但他高贵的气质却随着真情流露，胜过了有着华丽织体的热闹声音，当然，这首歌最迷人的，还是天衣无缝的合声部分–那轻轻的，起伏的，隐现并滑翔而逝的伴唱，只有真正胸怀开阔，品位脱俗的人才能这样写情歌，也只有真正温柔可爱的人才值得被这样的歌声围绕。</p>
</li>
<li><p>killing me softly with his song–roberta flack 由于年代久远，这首歌不可避免地带上了留声机时代遗留下来的贵族味道，一遍遍地重复“killing me softly with his song”，她已经醉了，已经无力逃脱了，她更象是自言自语，捧着胸口喃喃自语而脑子里眼睛里全是他全是他全是他啊…</p>
</li>
<li><p>can you feel the love tonight–Elton joh工整清晰的吐字，彬彬有礼的抒情，不紧不慢的钢琴，只能有那些拥有严谨文化传统的中老年英国人来展现。</p>
</li>
<li><p>lemon tree–fool’s gardon5个得国小伙子组成的“傻子花园”乐队，可根本没想过要写一首叫做《柠檬树》的英文歌，给一个台湾女孩子(苏慧伦)翻唱成中文版，在这个东方大国漂起！“ i wonder how, i wonder why, yesterday you tell me about the blue blue sky…”</p>
</li>
<li><p>vincent–don mclean这位歌词有着诗一样已经的青年为人了精神殉道者，荷兰后印象派画家，伟大的疯子文森特梵高献上了感人的一曲，这首歌唱到了艺术家的孤独和世人的不义，唱到了崇高的痛苦和爱，唱到了内心矛盾，唱到了神，宁静和永远…</p>
</li>
<li><p>one love–bob marley他用歌声带给人快乐，并为公正而斗争，这样的一生足以使任何一位歌者在死神面前保持尊严，牙买加总统参加了他的葬礼。</p>
</li>
<li><p>careless whisper–wham威猛是中国改革开放以来最早接受的西方流行音乐，现在听来真的是别有一番滋味。</p>
</li>
<li><p>don’t cry for me, argentina–madonna她卖弄，出售神圣？可是她并不比任何人虚伪，当她撕开人们的虚伪时，我们听到的是一副越唱越好的嗓子，和一种越来越真实的性格。阿根廷前总统夫人依维塔确有一生传奇的经历–寒门女子最终身居国母，用圣洁的博爱感动了整个国家，她为穷人所做的一切，她的真诚和无私，在歌声得到了永生…</p>
</li>
<li><p>two steps behind–defleppardKB海峡拥有高超的不鲁斯吉他技巧，低沉嗓音的半说半唱，成熟睿智的歌词，以及难以言表的宽厚情怀，整个八十年代，不知多少人依*他们的音乐，完成了由青春向成年的过渡，不知多少人被那悠远延绵的意境带走，超脱于现实的无聊纷争…</p>
</li>
<li><p>no more i love you–annie lennox此人于1995年推出了专辑“Medusa”(《美杜莎》)美杜莎，是希腊女神中最狰狞古怪的一个，把超人的魔力给了这个歌手，让她有力，跌宕起伏，在我们想象之上拖曳高音，延续着从唯美派文学到新古典音乐的影响，也徘徊在艺术和商业之间，沟通着尘世的想象。</p>
</li>
<li><p>my heart will go on–celine dio*我深信，这是即使Xia0xuesheng也听过而且非常喜欢的一首歌。</p>
</li>
<li><p>when a man loves a woman-meachael bolton这个男人具有轻易征服听众的才能，曾是美国电台播放给“面的”司机听的最佳人选，可以用最直接的方法来美化我们的听觉，而且，我们根本无须费心去听，只要跟着，哼着，忙自己的，快乐就产生了。</p>
</li>
<li><p>yesterday once more唱者卡伦卡彭特被称为美国的邓丽君，当她死于神经性厌食症时，人们突然发现，在所有那些包装精良，华美诱人的热门金曲中，可能只有卡伦卡彭特的声音值得被收藏，她把悠长的旋律唱得光芒耀眼，即使怀旧，都充满了对生活的感恩，她的歌声始终在呼唤人们热爱的本能。</p>
</li>
<li><p>goodbye–air supply 80年代最受欢迎的一对组合,他们高低的配合优美的歌词动听的旋律令人难以抗拒。喜欢这样凄美华丽的声音，唱出那句痛彻心肺的“There’s no other way than to say goodbye”</p>
</li>
<li><p>your song–Elton john平滑流畅的钢琴和Elton john淡淡柔情的演唱，似乎就是和爱人相拥坐在黄昏中的木屋顶，看远处夕阳西下，与世上最最甜美的双眸对望，任似水年华静静流淌，这时不用很多钱，不用大房子，只要有一首由爱人所唱，但却只属于自己的歌就足够了…</p>
</li>
<li><p>hotel california–Eagles我喜欢那充满磁性的嗓音，木吉他弹奏出简单幽怨的调子外，我想，喜欢它的另一个理由便是对回忆的孤独感受。这样的曲子，适合一个人听，一遍又一遍地重听，随乐韵飘荡到广袤却寂寥的！</p>
</li>
</ol>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/03/15/english-music-top100/" class="archive-article-date">
  	<time datetime="2016-03-15T14:33:57.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-03-15</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/music/">music</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/娱乐/">娱乐</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-Redis-vs-Memcache" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/12/Redis-vs-Memcache/">Redis与Memcache的对比</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <ol>
<li><p>它们都是C语言开发的(key-value)内存数据存储 </p>
</li>
<li><p>线程:</p>
<ul>
<li>redis 是单线程,使用epoll 多路复用io模型,非阻塞</li>
<li>memcache 为多线程,依赖libevent</li>
</ul>
</li>
<li><p>锁</p>
<ul>
<li><p>redis 中没有使用锁, 可以使用watch 命令添加乐观锁,一般结合事务使用 <code>multi ... exec  ||  discard</code>  </p>
<ul>
<li>watch命令会监视给定的key,当exec时候如果监视的key从调用watch后发生过变化，则整个事务会失败。也可以调用watch多次监视多个key.这 样就可以对指定的key加乐观锁了。注意watch的key是对整个连接有效的，事务也一样。如果连接断开，监视和事务都会被自动清除。当然了exec,discard,unwatch命令都会清除连接中的所有监视。</li>
<li>redis只能保证事务的每个命令连续执行，但是如果事务中的一个命令失败了，并不回滚其他命令</li>
</ul>
</li>
<li><p>乐观锁：  </p>
<ul>
<li>大多数是基于数据版本(version)的记录机制实现的。数据版本即为数据增加一个版本标识，在基于数据库表的版本解决方案中，一般是通过为数据库表添加一个 “version”字段来实现读取出数据时，将此版本号一同读出，之后更新时，对此版本号加1。</li>
<li>此时，将提交数据的版本号与数据库表对应记录的当前版本号进行比对，如果提交的数据版本号大于数据库表当前版本号，则予以更新，否则认为是过期数据。</li>
</ul>
</li>
<li><p>memcache是一个内存缓存，key的长度小于250字符，单个item存储要小于1M，不适合虚拟机使用</p>
</li>
<li><p>数据一致性不同  </p>
<ul>
<li>redis使用的是单线程模型，保证了数据按顺序提交。</li>
<li>memcache需要使用cas保证数据一致性。CAS（Check and Set）是一个确保并发一致性的机制，属于“乐观锁”范畴；原理很简单：拿版本号，操作，对比版本号，如果一致就操作，不一致就放弃任何操作</li>
</ul>
</li>
<li><p>cpu利用  </p>
<ul>
<li>redis单线程模型只能使用一个cpu，可以开启多个redis进程</li>
</ul>
</li>
</ul>
</li>
<li><p>incr &amp; decr</p>
<ul>
<li>Redis支持的整数型Value值的具体类型为带符号64-bit整数，而Memcached支持的整数型Value值的具体类型为无符号64-bit整数，这就导致两个系统支持的整数型Value值的取值范围是不一样的。Redis支持的整数型Value值范围是-9223372036854775808~9223372036854775807，而Memcached的范围则是0~18446744073709551615。</li>
<li>Redis 当数值达到最大或者最小极值时,再incr/decr 操作会报错(error)ERR increment or decrement would overflow</li>
<li>Memcache 当达到最大值时,incr key 1, 那么key=0; 当key=0时,decr key 1, 此时key仍然为0</li>
</ul>
</li>
<li><p>整体对比</p>
<ul>
<li>性能对比：由于Redis只使用单核，而Memcached可以使用多核，所以平均每一个核上Redis在存储小数据时比Memcached性 能更高。而在100k以上的数据中，Memcached性能要高于Redis，虽然Redis最近也在存储大数据的性能上进行优化，但是比起 Memcached，还是稍有逊色。</li>
<li>内存使用效率对比：使用简单的key-value存储的话，Memcached的内存利用率更高，而如果Redis采用hash结构来做key-value存储，由于其组合式的压缩，其内存利用率会高于Memcached。</li>
<li>Redis支持服务器端的数据操作：Redis相比Memcached来说，拥有更多的数据结构和并支持更丰富的数据操作，通常在 Memcached 里，你需要将数据拿到客户端来进行类似的修改再set回去。这大大增加了网络IO的次数和数据体积。在Redis中，这些复杂的操作通常和一般的 GET/SET一样高效。所以，如果需要缓存能够支持更复杂的结构和操作，那么Redis会是不错的选择。 </li>
</ul>
</li>
<li><p>Redis 快速的原因</p>
<ul>
<li>绝大部分请求是纯粹的内存操作（非常快速） </li>
<li>采用单线程,避免了不必要的上下文切换和竞争条件 </li>
<li>非阻塞IO,内部实现采用epoll，采用了epoll+自己实现的简单的事件框架。epoll中的读、写、关闭、连接都转化成了事件，然后利用epoll的多路复用特性，绝不在io上浪费一点时间 </li>
</ul>
<p>ps: 这3个条件不是相互独立的，特别是第一条，如果请求都是耗时的，采用单线程吞吐量及性能可想而知了。应该说redis为特殊的场景选择了合适的技术方案。</p>
</li>
<li><p>Redis 持久化</p>
<ul>
<li><p>rdb  内存快照直接 dump到 dump.rdb 文件中</p>
<ul>
<li>在 Redis 运行时， RDB 程序将当前内存中的数据库快照保存到磁盘文件中， 在 Redis 重启动时， RDB 程序可以通过载入 RDB 文件来还原数据库的状态。</li>
<li>save 命令阻塞主进程, bgsave 命令fork一个子进程来执行保存操作,因此不阻塞主进程</li>
</ul>
</li>
<li><p>aof 执行的命令追加到这个文件中(可以通过重写来优化:bgrewriteaof)  AppendOnlyFile   </p>
<ul>
<li>AOF 文件通过保存所有修改数据库的命令来记录数据库的状态。</li>
<li>AOF 文件中的所有命令都以 Redis 通讯协议的格式保存。</li>
<li>不同的 AOF 保存模式对数据的安全性、以及 Redis 的性能有很大的影响。</li>
<li>AOF 重写的目的是用更小的体积来保存数据库状态，整个重写过程基本上不影响 Redis 主进程处理命令请求。</li>
<li>AOF 重写是一个有歧义的名字，实际的重写工作是针对数据库的当前值来进行的，程序既不读写、也不使用原有的 AOF 文件。</li>
<li>AOF 可以由用户手动触发，也可以由服务器自动触发。</li>
</ul>
</li>
</ul>
</li>
<li><p>Redis 数据类型</p>
<ul>
<li>String</li>
<li>Set</li>
<li>Sorted Set</li>
<li>List</li>
<li>Hash</li>
</ul>
</li>
</ol>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考:"></a>参考:</h4><ol>
<li>Redis的设计与实现 <a href="http://redisbook.readthedocs.org/en/latest/index.html" target="_blank" rel="external">http://redisbook.readthedocs.org/en/latest/index.html</a></li>
<li>redis和memcache的对比 <a href="http://blog.csdn.net/u011386690/article/details/17469007" target="_blank" rel="external">http://blog.csdn.net/u011386690/article/details/17469007</a></li>
</ol>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/01/12/Redis-vs-Memcache/" class="archive-article-date">
  	<time datetime="2016-01-12T14:33:57.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-01-12</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/memcache/">memcache</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/redis/">redis</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/Redis/">Redis</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-php多线程" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/09/21/php多线程/">php多线程简单示例</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="判断PHP是ts还是nts版"><a href="#判断PHP是ts还是nts版" class="headerlink" title="判断PHP是ts还是nts版"></a>判断PHP是ts还是nts版</h3><ul>
<li>通过phpinfo(); 查看其中的 Thread Safety 项，这个项目就是查看是否是线程安全，如果是：enabled，一般来说应该是ts版，否则是nts版。</li>
</ul>
<h3 id="安装thread-扩展"><a href="#安装thread-扩展" class="headerlink" title="安装thread 扩展"></a>安装thread 扩展</h3><ul>
<li>wget <a href="https://github.com/krakjoe/pthreads/archive/master.zip" target="_blank" rel="external">https://github.com/krakjoe/pthreads/archive/master.zip</a></li>
<li>unzip mastar.zip</li>
<li>cd pthreads-master</li>
<li>/usr/local/php-fast/bin/phpize</li>
<li>./configure –with-php-config=/usr/local/php-fast/bin/php-config </li>
<li>make &amp;&amp; make install</li>
<li>修改php配置<ul>
<li>vi /usr/local/php-fast/lib/php.ini </li>
<li>extension=/usr/local/php-fast/lib/php/extensions/no-debug-zts-20121212/pthreads.so</li>
<li>重启php-fpm</li>
</ul>
</li>
<li>通过phpinfo() 可以查看到是否开启了 pthreads 扩展</li>
</ul>
<h3 id="多线程抓取网页与for循环代码示例"><a href="#多线程抓取网页与for循环代码示例" class="headerlink" title="多线程抓取网页与for循环代码示例"></a>多线程抓取网页与for循环代码示例</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">class test_thread_run extends Thread &#123; </div><div class="line"></div><div class="line">    public $url; </div><div class="line">    public $data; </div><div class="line"></div><div class="line">    public function __construct($url) &#123; </div><div class="line">        $this-&gt;url = $url; </div><div class="line">    &#125; </div><div class="line"></div><div class="line">    public function run() &#123; </div><div class="line">        if (($url = $this-&gt;url)) &#123; </div><div class="line">            $this-&gt;data = model_http_curl_get($url); </div><div class="line">        &#125; </div><div class="line">    &#125; </div><div class="line"></div><div class="line">&#125; </div><div class="line"></div><div class="line">function model_thread_result_get($urls_array) &#123; </div><div class="line">    foreach ($urls_array as $key =&gt; $value) &#123; </div><div class="line">        $thread_array[$key] = new test_thread_run($value[&quot;url&quot;]); </div><div class="line">        $thread_array[$key]-&gt;start(); </div><div class="line">    &#125; </div><div class="line"></div><div class="line">    foreach ($thread_array as $thread_array_key =&gt; $thread_array_value) &#123; </div><div class="line">        while ($thread_array[$thread_array_key]-&gt;isRunning()) &#123; </div><div class="line">            usleep(10); </div><div class="line">        &#125; </div><div class="line">        if ($thread_array[$thread_array_key]-&gt;join()) &#123; </div><div class="line">            $variable_data[$thread_array_key] = $thread_array[$thread_array_key]-&gt;data; </div><div class="line">        &#125; </div><div class="line">    &#125; </div><div class="line">    return $variable_data; </div><div class="line">&#125; </div><div class="line"></div><div class="line">function model_http_curl_get($url, $userAgent = &quot;&quot;) &#123; </div><div class="line">    $userAgent = $userAgent ? $userAgent : &apos;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)&apos;; </div><div class="line">    $curl = curl_init(); </div><div class="line">    curl_setopt($curl, CURLOPT_URL, $url); </div><div class="line">    curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1); </div><div class="line">    curl_setopt($curl, CURLOPT_TIMEOUT, 5); </div><div class="line">    curl_setopt($curl, CURLOPT_USERAGENT, $userAgent); </div><div class="line">    $result = curl_exec($curl); </div><div class="line">    curl_close($curl); </div><div class="line">    return $result; </div><div class="line">&#125; </div><div class="line"></div><div class="line">for ($i = 0; $i &lt; 100; $i++) &#123; </div><div class="line">    $urls_array[] = array(&quot;name&quot; =&gt; &quot;baidu&quot;, &quot;url&quot; =&gt; &quot;http://www.baidu.com/s?wd=&quot; . mt_rand(10000, 20000)); </div><div class="line">&#125; </div><div class="line">header(&apos;Content-Type:text/html;charset=utf-8;&apos;); </div><div class="line">$t = microtime(true); </div><div class="line">$result = model_thread_result_get($urls_array); </div><div class="line">$e = microtime(true); </div><div class="line">echo &quot;多线程：&quot; . ($e - $t) . &quot;&lt;br /&gt;&quot;; </div><div class="line"></div><div class="line">$t = microtime(true); </div><div class="line">foreach ($urls_array as $key =&gt; $value) &#123; </div><div class="line">    $result_new[$key] = model_http_curl_get($value[&quot;url&quot;]); </div><div class="line">&#125; </div><div class="line">$e = microtime(true); </div><div class="line">echo &quot;For循环：&quot; . ($e - $t) . &quot;\n&quot;; </div><div class="line">?&gt;</div></pre></td></tr></table></figure>
      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2015/09/21/php多线程/" class="archive-article-date">
  	<time datetime="2015-09-21T14:33:57.000Z" itemprop="datePublished"><i class="icon-clock"></i>2015-09-21</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/php/">php</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/php/">php</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-Some-Words-From-Movies" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/09/21/Some-Words-From-Movies/">Some words from movies</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Can you pull in the Leviathan with a fishhook or tie down his tongue with a rope?  </div><div class="line">Can you put a cord through his nose or pierce his jaw with a hook?</div><div class="line">Will it keep begging you for mercy? Will it speak to you with gentle words?  </div><div class="line">Nothing on earth is its equal. It si king over all that are proud.  </div><div class="line">    --- from &lt;Leviathan&gt; (电影 利维坦)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">To see the world, things dangerous to come to.</div><div class="line">To see behind walls, to draw closer, to find each other and to feel. </div><div class="line">That is the purpose of life.</div><div class="line">    --- from (电影 白日梦想家)</div></pre></td></tr></table></figure>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2015/09/21/Some-Words-From-Movies/" class="archive-article-date">
  	<time datetime="2015-09-21T09:00:00.000Z" itemprop="datePublished"><i class="icon-clock"></i>2015-09-21</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/movie/">movie</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/生活/">生活</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/3/">&laquo; Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/5/">Next &raquo;</a>
    </nav>
  


      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 Jason Zeng
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    <script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: false,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false,
		root: "/",
		innerArchive: true
	}
</script>

<script src="/./main.js"></script>


    
<div class="tools-col">
  <ul class="btn-wrap">
    
      <li class="chose" data-hook="tools-section-all"><span class="text">全部</span><i class="icon-book"></i></li>
    
    
      <li data-hook="tools-section-tag"><span class="text">标签</span><i class="icon-price-tags"></i></li>
    
    
    
  </ul>
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all chose">
    	</section>
    

    
    	<section class="tools-section tools-section-tag">
    			<div class="widget tagcloud" id="js-tagcloud">
    				<a href="/tags/Css/" style="font-size: 10px;">Css</a> <a href="/tags/Git/" style="font-size: 12.5px;">Git</a> <a href="/tags/Linux/" style="font-size: 10px;">Linux</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/js/" style="font-size: 17.5px;">js</a> <a href="/tags/markdown/" style="font-size: 10px;">markdown</a> <a href="/tags/memcache/" style="font-size: 10px;">memcache</a> <a href="/tags/movie/" style="font-size: 10px;">movie</a> <a href="/tags/music/" style="font-size: 10px;">music</a> <a href="/tags/mysql/" style="font-size: 10px;">mysql</a> <a href="/tags/nodejs/" style="font-size: 20px;">nodejs</a> <a href="/tags/php/" style="font-size: 12.5px;">php</a> <a href="/tags/promise/" style="font-size: 15px;">promise</a> <a href="/tags/redis/" style="font-size: 12.5px;">redis</a> <a href="/tags/sublime/" style="font-size: 12.5px;">sublime</a> <a href="/tags/vscode/" style="font-size: 10px;">vscode</a> <a href="/tags/windows/" style="font-size: 10px;">windows</a> <a href="/tags/每天学点js/" style="font-size: 17.5px;">每天学点js</a> <a href="/tags/读书笔记/" style="font-size: 10px;">读书笔记</a> <a href="/tags/转载/" style="font-size: 12.5px;">转载</a>
    			</div>
    	</section>
    

    

    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div>
</body>
</html>